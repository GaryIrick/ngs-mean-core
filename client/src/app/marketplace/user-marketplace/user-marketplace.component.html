<div class="container forceFull">
    <div class="row">
        <div class="col">

            <div class="row">
                <div class="col text-center">
                    <h4>Find A Player</h4>
                </div>
            </div>

            <div class="row" *ngIf="!showSearch">
                <div class="col">
                    <span class="finger showlink" (click)="showSearch = !showSearch">Show search criteria</span>
                </div>
            </div>
            <div *ngIf="showSearch">
                <div class="row">
                    <div>Search by In-Game Ranking: <span class="ml-5 finger badge badge-pill badge-light" (click)=" searchParameters.divisions = []; selectedDivision=null;">Reset</span></div>
                    <mat-form-field>
                        <mat-select placeholder="Division:" [(ngModel)]="selectedDivision" (ngModelChange)="selected(selectedDivision)" disableOptionCentering>
                            <mat-option *ngFor="let division of filterSelected()" [value]="division">{{division}}</mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>
                <div class="col">
                    <div>Selected Divisions</div>
                    <div *ngFor="let div of searchParameters.divisions">{{div}}</div>
                </div>
                <div class="col">
                    <div>Search by User Average MMR <span class="ml-5 finger badge badge-pill badge-light" (click)="resetMMRS()">Reset</span></div>
                    <div class="row">
                        <div class="col">
                            <mat-form-field>
                                <input matInput type="number" placeholder="Lower MMR" [(ngModel)]="searchParameters.lowerMMR">
                            </mat-form-field>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <mat-form-field>
                                <input matInput type="number" placeholder="Upper MMR" [(ngModel)]="searchParameters.upperMMR">
                            </mat-form-field>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col">
                        <div>User Competitive Level <span class="ml-5 finger badge badge-pill badge-light" (click)=" searchParameters.competitiveLevel = null">Reset</span>
                        </div>
                        <mat-form-field class="mat-FullWidth">
                            <mat-select placeholder="User Competitive Level" [(ngModel)]="searchParameters.competitiveLevel">
                                <mat-option *ngFor="let level of competitonLevel" [value]="level.val">
                                    {{level.display}}
                                </mat-option>
                            </mat-select>
                            <mat-hint align="start"><strong>Generally how serious / competitively you're looking to play</strong>
                            </mat-hint>
                        </mat-form-field>
                    </div>
                </div>

                <div class="row mt-3">
                    <div class="col">
                        <div>Users who play these roles: <span class="ml-5 finger badge badge-pill badge-light" (click)="resetRoles()">Reset</span></div>
                        <section>
                            <mat-checkbox class="role-margin" [(ngModel)]="searchParameters.rolesNeeded.tank">Tank</mat-checkbox>
                            <mat-checkbox class="role-margin" [(ngModel)]="searchParameters.rolesNeeded.offlane">Offlane</mat-checkbox>
                            <mat-checkbox class="role-margin" [(ngModel)]="searchParameters.rolesNeeded.meleeassassin">Melee Assassin</mat-checkbox>
                            <mat-checkbox class="role-margin" [(ngModel)]="searchParameters.rolesNeeded.rangedassassin">Ranged Assassin
                            </mat-checkbox>
                            <mat-checkbox class="role-margin" [(ngModel)]="searchParameters.rolesNeeded.support">Support</mat-checkbox>
                            <mat-checkbox class="role-margin" [(ngModel)]="searchParameters.rolesNeeded.flex">Flex</mat-checkbox>
                        </section>
                    </div>
                </div>

                <div class="row mt-3" *ngIf="teamInfo">
                    <div class="col">
                        <div>Times Available:</div>
                        <mat-radio-group class="ml-3" [(ngModel)]='searchParameters.customTime'>
                            <mat-radio-button class="example-margin" value="profile">Use my profile times</mat-radio-button>
                        </mat-radio-group>
                        <mat-radio-group class="ml-3" [(ngModel)]='searchParameters.customTime'>
                            <mat-radio-button class="example-margin" value="custom">Create custom time:</mat-radio-button>
                        </mat-radio-group>
                    </div>
                    <div class="col">
                        <div class="col">
                            <span class="finger badge badge-pill badge-light" (click)="searchParameters.customTime=null">Reset</span>
                        </div>
                    </div>
                </div>

                <div class="row" *ngIf="searchParameters.customTime  == 'custom'">
                    <div class="col">
                        <app-times-available [availObj]="searchParameters.customAvail"></app-times-available>
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col">
                        <div>Timezone:</div>
                        <!-- <mat-radio-group class="ml-3" [(ngModel)]='searchParameters.timezone'>
                        <mat-radio-button class="example-margin" value="profile">Use Profile Timezone</mat-radio-button>
                    </mat-radio-group> -->
                        <mat-radio-group class="ml-3" [(ngModel)]='searchParameters.timezone'>
                            <mat-radio-button class="example-margin" value="custom">Use Custom Timezone</mat-radio-button>
                        </mat-radio-group>
                    </div>
                    <div class="col">
                        <span class="finger badge badge-pill badge-light" (click)="searchParameters.timezone=null">Reset</span>
                    </div>
                </div>
                <div class="row" *ngIf="searchParameters.timezone == 'custom'">
                    <div class="col">
                        <mat-form-field class="mat-FullWidth">
                            <mat-select placeholder="Timezone:" [(ngModel)]="searchParameters.customtimeZone">
                                <mat-option *ngFor="let zone of timezone.timezones" [value]="zone.value">
                                    {{zone.text}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </div>

                <div class="row mt-3">
                    <div class="col text-center">
                        <button class="btn btn-info" (click)="search()"> Search </button>
                    </div>
                    <div class="col text-center">
                        <button class="btn btn-light" (click)="clear()"> Clear </button>
                    </div>
                </div>
            </div>

            <div *ngIf="rosterFull()" class="row mt-3">
                <div class="col text-center">
                    <span class="text-warning">
  <h4>Your roster is full, you have to many members/pending members to invite more users.</h4>
</span>
                </div>
            </div>

            <div class="row" *ngIf="hasSearched && localResults.length==0">
                <div class="col">
                    <h3>We did not find any users that matched your criteria.</h3>
                </div>
            </div>
            <!-- results go here -->
            <div class="row" *ngIf="displayArray.length>0">
                <div class="col">
                    <div class="row mt-4">
                        <div class="col">
                            <h4 *ngIf="!showSearch">Showing All Teams:</h4>
                            <h4 *ngIf="showSearch && localResults.length>0;">Showing Users That Meet Your Criteria</h4>
                        </div>
                    </div>
                    <mat-paginator [length]="length" [pageSize]="pageSize" (page)="pageEventHandler($event)">

                    </mat-paginator>
                    <div class="row mt-2 p-3 rowBorder" *ngFor="let player of displayArray; let ind = index" [ngClass]="{oddRow : ind%2!=0}">
                        <!-- <div class="col">
                            <div class="row">
                                <div class="col">
                                    <img class="img-fluid" src="{{_team.imageFQDN(team.logo)}}">
                                </div>
                            </div>
                        </div> -->
                        <div class="col">
                            <div class="row">
                                <div class="col">
                                    <span class="titles">Player Name:</span> {{player.displayName}}
                                </div>
                                <div class="col">
                                    <span class="titles">HL Ranking:</span> {{player.hlRankMetal}}
                                    <div>
                                        <span class="titles">HL Division: </span>{{player.hlRankDivision}}
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-2">
                                <div class="col">
                                    <span class="titles">MMR:</span> {{player.averageMmr}}
                                </div>
                                <div class="col">
                                    <span class="titles">Hots Logs:</span><a href="{{player.hotsLogsURL}}" target="_blank"> Link</a>
                                </div>
                            </div>
                            <div class="row mt-2">
                                <div class="col-6">
                                    <a [routerLink]="['/profile/',_userService.routeFriendlyUsername(player.displayName)]">View User Profile</a>
                                </div>
                                <div *ngIf="!rosterFull()">
                                    <div class="col text-center" *ngIf="showInviteButton(player) == 'notinvited'">
                                        <button class="btn btn-success" (click)="requestToJoin(player)">Invite to Team</button>
                                    </div>
                                    <div class="col text-center" *ngIf="showInviteButton(player) == 'invited'">
                                        <span class="badge badge-pill badge-info font-italic">Invited!</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>